version: 2.1

jobs: # a basic unit of work in a run
  test: # your job name
    macos:
      xcode: 13.4.1  # indicate your selected version of Xcode
    steps: # a series of commands to run
      - checkout  # pull down code from your version control system.
      - run:
          name: Run Unit Tests
          command: xcodebuild test -scheme Circle-Ci-Test-App -destination 'platform=iOS Simulator,name=iPhone 12,OS=15.5'

  build:
    macos:
      xcode: 13.4.1 # indicate your selected version of Xcode
    steps:
      - checkout
      - run:
          # build our application
          name: Build Application
          command: xcodebuild

workflows:
  test_build:
    jobs:
      - test
      - build:
          requires: # sequence the build job to run after test
            - test